<html> <title>Convo IRL</title> <head> <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=0"> </head> <body> <canvas id="game"></canvas> <style>body,html{margin:0;padding:0}#game,body,html{height:100%;width:100%}#game{-ms-interpolation-mode:nearest-neighbor;image-rendering:optimizeSpeed;image-rendering:-moz-crisp-edges;image-rendering:-o-crisp-edges;image-rendering:-webkit-optimize-contrast;image-rendering:optimize-contrast;image-rendering:crisp-edges;image-rendering:pixelated;z-index:2}</style> <script>parcelRequire=function(e,r,n,t){var i="function"==typeof parcelRequire&&parcelRequire,o="function"==typeof require&&require;function u(n,t){if(!r[n]){if(!e[n]){var f="function"==typeof parcelRequire&&parcelRequire;if(!t&&f)return f(n,!0);if(i)return i(n,!0);if(o&&"string"==typeof n)return o(n);var c=new Error("Cannot find module '"+n+"'");throw c.code="MODULE_NOT_FOUND",c}p.resolve=function(r){return e[n][1][r]||r};var l=r[n]=new u.Module(n);e[n][0].call(l.exports,p,l,l.exports,this)}return r[n].exports;function p(e){return u(p.resolve(e))}}u.isParcelRequire=!0,u.Module=function(e){this.id=e,this.bundle=u,this.exports={}},u.modules=e,u.cache=r,u.parent=i,u.register=function(r,n){e[r]=[function(e,r){r.exports=n},{}]};for(var f=0;f<n.length;f++)u(n[f]);if(n.length){var c=u(n[n.length-1]);"object"==typeof exports&&"undefined"!=typeof module?module.exports=c:"function"==typeof define&&define.amd?define(function(){return c}):t&&(this[t]=c)}return u}({"5ywg":[function(require,module,exports) {
"use strict";var e,t;exports.__esModule=!0,function(e){e[e.Up=0]="Up",e[e.Down=1]="Down",e[e.Left=2]="Left",e[e.Right=3]="Right"}(e=exports.Direction||(exports.Direction={})),function(e){e[e.Buddy=0]="Buddy",e[e.Tile=1]="Tile"}(t=exports.InteractableType||(exports.InteractableType={})),exports.TILE_SIZE=8,exports.HALF_TILE_SIZE=exports.TILE_SIZE/2,exports.SQUARE_SIZE=5,exports.MS_PER_UPDATE=1/60,exports.NUM_TILES_ON_LONG_SIDE=16,exports.BLINK_DURATION=750,exports.LINE_HEIGHT=50,exports.DISABLED_ALPHA=.5;
},{}],"eAYL":[function(require,module,exports) {
"use strict";exports.__esModule=!0;var r=require("./common");function n(n,t,e){var o=t.x>=0&&t.x<=e.size.width-n.size.width&&t.y>=0&&t.y<e.size.height,i=t.x,a=t.y;i/=r.TILE_SIZE,a/=r.TILE_SIZE;var u=e.tilesGrid[a][i].walkable;return o&&u}function t(r,n){if(r.running)return!1;var t=n-r.startTime>r.minTimeDelta,e=r.percentChance>Math.random();return t&&e}function e(r,n,t){return(1-t)*r+t*n}function o(r,n,t){return Math.max(Math.min(r,t),n)}function i(r,n,t,i,a){return o(e(r,n,a),t,i)}function a(){return 2*Math.round(Math.random())-1}function u(r){return[].concat.apply([],r)}function l(r){return r[Math.floor(Math.random()*r.length)]}function s(r){return Math.floor(Math.random()*r.length)}function c(r,n,t,e){void 0===e&&(e=!1);var o=t,a=n;return e&&(o=n,a=t),r>=.5?i(o,a,n,t,(r-.5)/.5):i(a,o,n,t,r/.5)}function h(n){return new Array(r.TILE_SIZE).fill(null).map(function(){return new Array(r.TILE_SIZE).fill(n)})}exports.canThingMoveToPosition=n,exports.shouldDoAnimation=t,exports.lerp=e,exports.clerp=i,exports.oneOrMinusOne=a,exports.flatten=u,exports.randomElementFromArray=l,exports.randomIndexFromArray=s,exports.twoPhaseClerp=c,exports.singleColorTileArray=h;
},{"./common":"5ywg"}],"LnVe":[function(require,module,exports) {
"use strict";exports.__esModule=!0;var s=require("./helpers"),e=.9,i=10,t=.01,h=function(){function h(s){this.pos={x:0,y:0},this.size={width:0,height:0},this.game=s,this.player=s.player,this.size={width:s.canvas.width,height:s.canvas.height},this.shake={amplitude:0,dir:{x:1,y:1},pos:{x:0,y:0}}}return Object.defineProperty(h.prototype,"offset",{get:function(){return{x:this.shake.pos.x+this.pos.x,y:this.shake.pos.y+this.pos.y}},enumerable:!0,configurable:!0}),h.prototype.move=function(s){this.pos.x=this.game.canvas.width/2-s.pos.x*this.game.squareSize-s.drawingSize.width/2,this.pos.y=this.game.canvas.height/2-s.pos.y*this.game.squareSize-s.drawingSize.height/2;var e=-1*(this.game.currentLevel.drawingSize.width-this.size.width),i=-1*(this.game.currentLevel.drawingSize.height-this.size.height);this.pos.x>0&&(this.pos.x=0),this.pos.x<e&&(this.pos.x=e),this.pos.y>0&&(this.pos.y=0),this.pos.y<i&&(this.pos.y=i)},h.prototype.shakeScreen=function(){this.shake.pos={x:0,y:0},this.shake.amplitude=i*this.game.squareSize,this.shake.dir.x=s.oneOrMinusOne(),this.shake.dir.y=s.oneOrMinusOne()},h.prototype.updateScreenShake=function(s){this.shake.amplitude*=e;var i=this.shake,h=i.amplitude,a=i.dir;Math.abs(h)<=t?(this.shake.pos.x=0,this.shake.pos.y=0):(this.shake.pos.x=Math.sin(s/50)*h*a.x,this.shake.pos.y=Math.sin(s/50)*h*a.y)},h}();exports.default=h;
},{"./helpers":"eAYL"}],"oinf":[function(require,module,exports) {
"use strict";exports.__esModule=!0;var e={duration:300,minTimeDelta:3e3,openness:1,percentChance:.5,running:!1,startTime:0};exports.blinking=e;var n={duration:0,minTimeDelta:1e3,offset:0,percentChance:.008,running:!1,startTime:0};exports.lookAway=n;var r={duration:400,endPos:{x:0,y:0},running:!1,startTime:0};exports.walking=r;var t={duration:1e3,nextLevelAlpha:0,prevLevelAlpha:1,prevLevelScale:1,running:!1,startTime:0};exports.transition=t;
},{}],"aYI3":[function(require,module,exports) {
"use strict";exports.__esModule=!0,exports.default=["#3e2d2e","#eeeec7","#96c083","#5fa367","#eeeec7","#dec26d","#6e4c49","#3e625e","#4c547a","#66ccff"];
},{}],"UQVz":[function(require,module,exports) {
"use strict";var i=this&&this.__importDefault||function(i){return i&&i.__esModule?i:{default:i}};exports.__esModule=!0;var t=i(require("./colors")),e=require("./helpers"),s=1400,h=1,r=3,o=.3,n=function(){function i(i){this.size={width:1,height:1},this.pos={x:0,y:0},this.color=t.default[1],this.visible=!1,this.alpha=1,this.percentGrown=0,this.game=i,this.drawingSize={height:this.size.height*this.game.squareSize,width:this.size.width*this.game.squareSize}}return i.prototype.reJuice=function(i,t,e){this.pos.x=t,this.pos.y=e,this.percentGrown=0,this.startTime=i,this.visible=!0},i.prototype.update=function(i){this.visible&&(this.percentGrown=(i-this.startTime)/s,this.visible=!(this.percentGrown>=1),this.alpha=e.clerp(o,0,0,o,this.percentGrown))},i.prototype.draw=function(i,t){var s=e.clerp(h,r,h,r,this.percentGrown);i.globalAlpha=this.alpha,i.fillStyle=this.color,i.fillRect(-this.drawingSize.width*s/2,-this.drawingSize.height*s/2,this.drawingSize.width*s,this.drawingSize.height*s)},i}();exports.default=n;
},{"./colors":"aYI3","./helpers":"eAYL"}],"tOHD":[function(require,module,exports) {
"use strict";var i=this&&this.__importDefault||function(i){return i&&i.__esModule?i:{default:i}};exports.__esModule=!0;var t=i(require("./dust")),n=require("./helpers"),e=require("./common"),s=require("./animations"),o=2,a=1,h="rgb(255, 255, 255)",r="rgb(0, 0, 0)",l=4,g=1,u=4,m=30,d=50,p=30,c=["#94725d","#bfa17a","#eeeec7","#5a444e","#cd9957","#3e2d2e"],y="left",f="right",w=function(){function i(i){var o=this;this.drawingSize={width:e.TILE_SIZE,height:e.TILE_SIZE},this.pos={x:e.TILE_SIZE,y:e.TILE_SIZE},this.size={width:e.TILE_SIZE,height:e.TILE_SIZE},this.visible=!0,this.skills=["weather","sports","pastries","france","cats"],this.tileIndex={x:0,y:0},this.interactableType=e.InteractableType.Buddy,this.energy=1,this.animations={},this.rot=Math.PI,this.lastDustAt=0,this.inConvoMode=!1,this.convoLookRight=!1,this.game=i,this.animations.blinking=Object.assign({},s.blinking),this.animations.walking=Object.assign({},s.walking,{endPos:this.pos}),this.animations.lookAway=Object.assign({},s.lookAway),this.color=n.randomElementFromArray(c),this.dusts=Array.from(Array(d).keys()).map(function(){return new t.default(o.game)}),this.drawingSize.width=e.TILE_SIZE*this.game.squareSize,this.drawingSize.height=e.TILE_SIZE*this.game.squareSize}return Object.defineProperty(i.prototype,"blinking",{get:function(){return this.animations.blinking.running},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"walking",{get:function(){return this.animations.walking.running},enumerable:!0,configurable:!0}),i.prototype.setConvoMode=function(i){this.inConvoMode=i,this.rot=Math.PI},i.prototype.convoLook=function(i){i===e.Direction.Right?this.convoLookRight=!0:i===e.Direction.Left&&(this.convoLookRight=!1)},i.prototype.move=function(i,t){void 0===t&&(t=!0),this.pos.x=i.x,this.pos.y=i.y,this.tileIndex.x=Math.ceil(this.pos.x/e.TILE_SIZE),this.tileIndex.y=Math.ceil(this.pos.y/e.TILE_SIZE),t||(this.animations.walking.endPos.x=i.x,this.animations.walking.endPos.y=i.y)},i.prototype.walk=function(i){var t=this.pos,s=t.x,o=t.y;i===e.Direction.Left?(this.rot=-Math.PI/2,s-=this.game.tileSize):i===e.Direction.Right?(this.rot=Math.PI/2,s+=this.game.tileSize):i===e.Direction.Down?(this.rot=Math.PI,o+=this.game.tileSize):i===e.Direction.Up&&(this.rot=0,o-=this.game.tileSize);var a={x:s,y:o};n.canThingMoveToPosition(this,a,this.game.currentLevel)&&this.configureWalkingAnimation(a)},i.prototype.configureWalkingAnimation=function(i){this.animations.walking.startTime=this.game.timestamp,this.animations.walking.endPos=i,this.animations.walking.running=!0},i.prototype.updateWalkingPosition=function(i){if(this.walking){var t=(i-this.animations.walking.startTime)/this.animations.walking.duration,e=n.lerp(this.pos.x,this.animations.walking.endPos.x,t),s=n.lerp(this.pos.y,this.animations.walking.endPos.y,t);t>=1&&(e=this.animations.walking.endPos.x,s=this.animations.walking.endPos.y,this.animations.walking.running=!1),this.move({x:e,y:s})}},i.prototype.draw=function(i,t){if(this.updateWalkingPosition(t),i.translate(this.drawingSize.width/2,this.drawingSize.height/2),i.rotate(this.rot),i.translate(-this.drawingSize.width/2,-this.drawingSize.height/2),i.fillStyle=this.color,i.fillRect(0,0,this.drawingSize.width,this.drawingSize.height),this.maybeDoEyeAnimations(t),this.drawEye(i,y,this.animations.blinking.openness,this.animations.lookAway.offset),this.drawEye(i,f,this.animations.blinking.openness,this.animations.lookAway.offset),this.walking&&t-this.lastDustAt>p){var n=this.dusts.find(function(i){return!i.visible});if(n){var e=this.size.width/2*Math.random()+this.size.width/4,s=this.size.height/2*Math.random()+this.size.height/4,o=this.pos.x+e,a=this.pos.y+s;n.reJuice(t,o,a),this.lastDustAt=t}}},i.prototype.maybeDoEyeAnimations=function(i){var t=this.animations,e=t.blinking,s=t.lookAway;n.shouldDoAnimation(e,i)&&(e.running=!0,e.startTime=i),n.shouldDoAnimation(s,i)&&(s.running=!0,s.startTime=i),this.runBlinkingAnimation(e,i),this.runLookAwayAnimation(s)},i.prototype.runLookAwayAnimation=function(i){i.running&&(i.offset=0===i.offset?1:0,i.running=!1)},i.prototype.runBlinkingAnimation=function(i,t){var e=(t-i.startTime)/i.duration;i.openness=n.twoPhaseClerp(e,0,1,!0),e>=1&&(i.running=!1)},i.prototype.drawEye=function(i,t,n,e){var s=t===y?0:l*this.game.squareSize;i.fillStyle=r;var d=g,p=0;this.inConvoMode&&(d=u),this.inConvoMode&&this.convoLookRight&&(p=m);var c=d*this.game.squareSize,f=o*this.game.squareSize,w=a*this.game.squareSize;i.fillRect(c+s-p,c,f,f*n),i.fillStyle=h,i.fillRect(c+s+e*this.game.squareSize-p,c,w,w*n)},i}();exports.default=w;
},{"./dust":"UQVz","./helpers":"eAYL","./common":"5ywg","./animations":"oinf"}],"pM81":[function(require,module,exports) {
"use strict";var e=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};exports.__esModule=!0;var t=e(require("../colors")),a=require("../common"),r=require("../helpers"),i=5,l=function(){function e(e){this.overlayDrawables=[],this.updateables=[],this.interactables=[],this.backgroundColor=t.default[2],this.game=e}return e.prototype.levelWillStart=function(){},e.prototype.levelStarted=function(){},e.prototype.update=function(e){this.updateables.forEach(function(t){return t.update(e)})},e.prototype.configureDrawablesAndUpdateables=function(){this.clearDrawables(),this.clearOverlayDrawables(),this.clearUpdateables(),this.clearInteractables()},e.prototype.tileAtIndex=function(e){return this.tilesGrid[e.y][e.x]},e.prototype.generateTiles=function(){var e=this,t=this.tileIndexes[0].length*a.TILE_SIZE,i=this.tileIndexes.length*a.TILE_SIZE;this.size={width:t,height:i},this.drawingSize={width:t*this.game.squareSize,height:i*this.game.squareSize},this.tilesGrid=this.tileIndexes.map(function(t,a){return t.map(function(t,r){return new e.tileTypeMap[t](e.game,r,a)})}),this.tiles=r.flatten(this.tilesGrid)},e.prototype.addDrawables=function(e,t){var a;(a=this.drawables[t]).push.apply(a,e)},e.prototype.addOverlayDrawables=function(e){var t;(t=this.overlayDrawables).push.apply(t,e)},e.prototype.addUpdateables=function(e){var t;(t=this.updateables).push.apply(t,e)},e.prototype.addInteractables=function(e){var t;(t=this.interactables).push.apply(t,e)},e.prototype.clearDrawables=function(){this.drawables=new Array(i).fill(null).map(function(){return(new Array).fill(null)})},e.prototype.clearOverlayDrawables=function(){this.overlayDrawables=[]},e.prototype.clearUpdateables=function(){this.updateables=[]},e.prototype.clearInteractables=function(){this.interactables=[]},e.prototype.generateTileIndexes=function(){var e=this,t=this.game.sizeInTiles();this.tileIndexes=new Array(t.height).fill(null).map(function(){return new Array(t.width).fill(null).map(function(){return r.randomIndexFromArray(e.tileTypeMap)})})},e}();exports.default=l;
},{"../colors":"aYI3","../common":"5ywg","../helpers":"eAYL"}],"Koi2":[function(require,module,exports) {
"use strict";var i=this&&this.__importDefault||function(i){return i&&i.__esModule?i:{default:i}};exports.__esModule=!0;var t=i(require("./colors")),s=require("./common"),e=function(){function i(i,e,h,o){void 0===o&&(o=t.default[8]),this.pos={x:0,y:0},this.size={height:s.SQUARE_SIZE,width:s.SQUARE_SIZE},this.visible=!0,this.alpha=1,this.strokePos={x:0,y:0},this.game=i,this.pos=e,this.size=h,this.color=o,this.drawingSize={height:this.size.height*this.game.squareSize,width:this.size.width*this.game.squareSize},this.move(e)}return i.prototype.move=function(i){this.pos.x=i.x,this.pos.y=i.y,this.strokePos.x=Math.floor(this.pos.x)+.5,this.strokePos.y=Math.floor(this.pos.y)+.5},i.prototype.updateSize=function(i){this.size.height=i.height,this.size.width=i.width,this.drawingSize.height=this.size.height*this.game.squareSize,this.drawingSize.width=this.size.width*this.game.squareSize},i.prototype.draw=function(i){i.fillStyle=this.color,i.fillRect(this.pos.x,this.pos.y,this.drawingSize.width,this.drawingSize.height),i.strokeStyle=t.default[1],i.fillStyle=t.default[1],i.lineWidth=this.game.squareSize,i.strokeRect(this.strokePos.x,this.strokePos.y,this.drawingSize.width,this.drawingSize.height)},i}();exports.default=e;
},{"./colors":"aYI3","./common":"5ywg"}],"VVJ9":[function(require,module,exports) {
"use strict";exports.__esModule=!0,exports.default={A:[[,1],[1,,1],[1,,1],[1,1,1],[1,,1]],B:[[1,1],[1,,1],[1,1,1],[1,,1],[1,1]],C:[[1,1,1],[1],[1],[1],[1,1,1]],D:[[1,1],[1,,1],[1,,1],[1,,1],[1,1]],E:[[1,1,1],[1],[1,1,1],[1],[1,1,1]],F:[[1,1,1],[1],[1,1],[1],[1]],G:[[,1,1],[1],[1,,1,1],[1,,,1],[,1,1]],H:[[1,,1],[1,,1],[1,1,1],[1,,1],[1,,1]],I:[[1,1,1],[,1],[,1],[,1],[1,1,1]],J:[[1,1,1],[,,1],[,,1],[1,,1],[1,1,1]],K:[[1,,,1],[1,,1],[1,1],[1,,1],[1,,,1]],L:[[1],[1],[1],[1],[1,1,1]],M:[[1,1,1,1,1],[1,,1,,1],[1,,1,,1],[1,,,,1],[1,,,,1]],N:[[1,,,1],[1,1,,1],[1,,1,1],[1,,,1],[1,,,1]],O:[[1,1,1],[1,,1],[1,,1],[1,,1],[1,1,1]],P:[[1,1,1],[1,,1],[1,1,1],[1],[1]],Q:[[0,1,1],[1,,,1],[1,,,1],[1,,1,1],[1,1,1,1]],R:[[1,1],[1,,1],[1,,1],[1,1],[1,,1]],S:[[1,1,1],[1],[1,1,1],[,,1],[1,1,1]],T:[[1,1,1],[,1],[,1],[,1],[,1]],U:[[1,,1],[1,,1],[1,,1],[1,,1],[1,1,1]],V:[[1,,,,1],[1,,,,1],[,1,,1],[,1,,1],[,,1]],W:[[1,,,,1],[1,,,,1],[1,,,,1],[1,,1,,1],[1,1,1,1,1]],X:[[1,,,,1],[,1,,1],[,,1],[,1,,1],[1,,,,1]],Y:[[1,,1],[1,,1],[,1],[,1],[,1]],Z:[[1,1,1,1,1],[,,,1],[,,1],[,1],[1,1,1,1,1]],0:[[1,1,1],[1,,1],[1,,1],[1,,1],[1,1,1]],1:[[,1],[,1],[,1],[,1],[,1]],2:[[1,1,1],[,,1],[1,1,1],[1,,],[1,1,1]],3:[[1,1,1],[,,1],[1,1,1],[,,1],[1,1,1]],4:[[1,,1],[1,,1],[1,1,1],[,,1],[,,1]],5:[[1,1,1],[1,0,0],[1,1,1],[0,0,1],[1,1,1]],6:[[1,1,1],[1,0,0],[1,1,1],[1,0,1],[1,1,1]],7:[[1,1,1],[0,0,1],[0,0,1],[0,0,1],[0,0,1]],8:[[1,1,1],[1,0,1],[1,1,1],[1,0,1],[1,1,1]],9:[[1,1,1],[1,,1],[1,1,1],[,,1],[1,1,1]]," ":[[,],[,],[,],[,],[,]],".":[[,,],[,,],[,,],[1,1],[1,1]],"^":[[,,,,],[,,1,,],[,1,1,1],[1,1,1,1,1],[1,1,1,1,1]],_:[[,,,,],[1,1,1,1,1],[1,1,1,1,1],[,1,1,1],[,,1,,]]};
},{}],"27c9":[function(require,module,exports) {
"use strict";var e=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};exports.__esModule=!0;var t=e(require("./colors")),i=e(require("./letters")),s=require("./common"),r=t.default[0],a=2,h=function(){function e(e,s,r,a){void 0===r&&(r=t.default[1]),void 0===a&&(a={x:0,y:0}),this.words="",this.visible=!0,this.shadow=!0,this.alpha=1,this.game=e,this.words=s.toUpperCase(),this.color=r,this.pos=a,this.pixelLetters=this.words.split("").map(function(e){return i.default[e]}),this.updateSize(),this.drawingSize={height:this.size.height*this.game.squareSize,width:this.size.width*this.game.squareSize}}return e.prototype.draw=function(e){var t=this,i=this.pos.x;e.globalAlpha=this.alpha,this.pixelLetters.forEach(function(s){for(var h=t.pos.y,o=0,u=0;u<s.length;u++){for(var l=s[u],n=0;n<l.length;n++)l[n]&&(t.shadow&&(e.fillStyle=r,e.fillRect(i+n*t.game.squareSize+a,h+a,t.game.squareSize,t.game.squareSize)),e.fillStyle=t.color,e.fillRect(i+n*t.game.squareSize,h,t.game.squareSize,t.game.squareSize));o=Math.max(o,l.length*t.game.squareSize),h=t.game.squareSize*(u+1)+t.pos.y}i+=t.game.squareSize+o})},e.prototype.move=function(e){this.pos.x=e.x,this.pos.y=e.y},e.prototype.resize=function(){this.drawingSize.width=this.size.width*this.game.squareSize,this.drawingSize.height=this.size.height*this.game.squareSize},e.prototype.updateSize=function(){var e=this.pixelLetters.map(function(e){return Math.max.apply(Math,e.map(function(e){return e.length}))}).reduce(function(e,t){return e+t},0)+this.pixelLetters.length-1;this.size={width:e,height:s.SQUARE_SIZE}},e}();exports.default=h;
},{"./colors":"aYI3","./letters":"VVJ9","./common":"5ywg"}],"1p/C":[function(require,module,exports) {
"use strict";exports.__esModule=!0;var e=require("../common"),a={door:{squareSize:e.SQUARE_SIZE,canvas:null},flowers:{squareSize:e.SQUARE_SIZE,canvas:null},grass:{squareSize:e.SQUARE_SIZE,canvas:null},green:{squareSize:e.SQUARE_SIZE,canvas:null},house:{squareSize:e.SQUARE_SIZE,canvas:null},sky:{squareSize:e.SQUARE_SIZE,canvas:null},tree:{squareSize:e.SQUARE_SIZE,canvas:null},unwalkable:{squareSize:e.SQUARE_SIZE,canvas:null}};exports.default=a;
},{"../common":"5ywg"}],"uUjA":[function(require,module,exports) {
"use strict";var e=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};exports.__esModule=!0;var t=e(require("../colors")),i=e(require("./tile-cache")),a=require("../common"),s=require("../helpers"),h=function(){function e(e,t,i){this.drawingSize={width:a.TILE_SIZE,height:a.TILE_SIZE},this.pos={x:0,y:0},this.alpha=1,this.size={width:a.TILE_SIZE,height:a.TILE_SIZE},this.walkable=!0,this.visible=!0,this.interactable=!1,this.interactableType=a.InteractableType.Tile,this.tileLength=a.TILE_SIZE,this.game=e,this.pos={x:t*a.TILE_SIZE,y:i*a.TILE_SIZE},this.tileIndex={x:t,y:i},this.drawingSize={height:this.tileLength*this.game.squareSize,width:this.tileLength*this.game.squareSize}}return Object.defineProperty(e.prototype,"offscreenCanvas",{get:function(){return i.default[this.name].canvas},enumerable:!0,configurable:!0}),e.prototype.draw=function(e){e.drawImage(this.offscreenCanvas,0,0),i.default[this.name].squareSize!==this.game.squareSize&&(this.drawingSize.width=this.tileLength*this.game.squareSize,this.drawingSize.height=this.tileLength*this.game.squareSize)},e.prototype.cacheOffscreenContext=function(){var e=this,a=document.createElement("canvas");a.width=this.drawingSize.width,a.height=this.drawingSize.height;var h=a.getContext("2d");s.flatten(this.colorMatrix).map(function(e){return t.default[e]}).forEach(function(t,i){if(t){h.fillStyle=t;var a=e.game.squareSize*(i%e.tileLength),s=e.game.squareSize*Math.floor(i/e.tileLength);h.fillRect(a,s,e.game.squareSize,e.game.squareSize)}}),i.default[this.name].squareSize=this.game.squareSize,i.default[this.name].canvas=a},e}();exports.default=h;
},{"../colors":"aYI3","./tile-cache":"1p/C","../common":"5ywg","../helpers":"eAYL"}],"A1jt":[function(require,module,exports) {
"use strict";var t=this&&this.__extends||function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r])};return function(e,r){function o(){this.constructor=e}t(e,r),e.prototype=null===r?Object.create(r):(o.prototype=r.prototype,new o)}}(),e=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};exports.__esModule=!0;var r=e(require("./tile")),o=function(e){function r(t,r,o){var n=e.call(this,t,r,o)||this;return n.name="flowers",n.colorMatrix=[[2,2,2,2,2,2,2,2],[2,2,5,2,2,2,3,2],[2,5,4,5,2,2,2,2],[2,2,5,2,2,2,2,2],[2,2,2,2,2,2,2,2],[2,2,2,2,2,2,2,2],[2,2,3,2,2,2,2,2],[2,2,2,2,2,2,2,2]],n.cacheOffscreenContext(),n}return t(r,e),r}(r.default);exports.default=o;
},{"./tile":"uUjA"}],"978g":[function(require,module,exports) {
"use strict";var t=this&&this.__extends||function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r])};return function(e,r){function o(){this.constructor=e}t(e,r),e.prototype=null===r?Object.create(r):(o.prototype=r.prototype,new o)}}(),e=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};exports.__esModule=!0;var r=e(require("./tile")),o=require("../helpers"),n=function(e){function r(t,r,n){var i=e.call(this,t,r,n)||this;return i.name="green",i.colorMatrix=o.singleColorTileArray(2),i.cacheOffscreenContext(),i}return t(r,e),r}(r.default);exports.default=n;
},{"./tile":"uUjA","../helpers":"eAYL"}],"I87v":[function(require,module,exports) {
"use strict";var t=this&&this.__extends||function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r])};return function(e,r){function o(){this.constructor=e}t(e,r),e.prototype=null===r?Object.create(r):(o.prototype=r.prototype,new o)}}(),e=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};exports.__esModule=!0;var r=e(require("./tile")),o=require("../helpers"),n=function(e){function r(t,r,n){var i=e.call(this,t,r,n)||this;return i.name="sky",i.colorMatrix=o.singleColorTileArray(9),i.cacheOffscreenContext(),i}return t(r,e),r}(r.default);exports.default=n;
},{"./tile":"uUjA","../helpers":"eAYL"}],"liEn":[function(require,module,exports) {
"use strict";var t=this&&this.__extends||function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r])};return function(e,r){function o(){this.constructor=e}t(e,r),e.prototype=null===r?Object.create(r):(o.prototype=r.prototype,new o)}}(),e=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};exports.__esModule=!0;var r=e(require("./tile")),o=null,n=function(e){function r(t,r,n){var u=e.call(this,t,r,n)||this;return u.name="tree",u.walkable=!1,u.colorMatrix=[[o,o,o,o,o,o,o,o],[o,o,7,7,7,7,o,o],[o,7,7,7,7,7,7,o],[o,7,7,7,7,7,7,o],[o,o,7,7,7,7,o,o],[o,o,o,6,6,o,o,o],[o,o,o,6,6,o,o,o],[o,o,6,6,6,6,o,o]],u.cacheOffscreenContext(),u}return t(r,e),r}(r.default);exports.default=n;
},{"./tile":"uUjA"}],"jLKC":[function(require,module,exports) {
"use strict";var e=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])};return function(t,i){function r(){this.constructor=t}e(t,i),t.prototype=null===i?Object.create(i):(r.prototype=i.prototype,new r)}}(),t=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};exports.__esModule=!0;var i=t(require("./level")),r=t(require("../box")),s=t(require("../buddy")),o=t(require("../colors")),a=t(require("../text")),n=t(require("../tiles/flowers")),h=t(require("../tiles/green")),l=t(require("../tiles/sky")),u=t(require("../tiles/tree")),d=require("../common"),p=require("../helpers"),c=7,w=2*d.TILE_SIZE,g=4*d.TILE_SIZE,f=2,x=2,m=function(t){function i(e){var i=t.call(this,e)||this;return i.backgroundColor=o.default[9],i.tileTypeMap=[h.default,n.default,l.default,u.default],i.tileIndexes=[[]],i.currentSkillIndex=0,i.box=new r.default(i.game,{x:0,y:0},{height:0,width:0}),i.upArrow=new a.default(i.game,"^"),i.downArrow=new a.default(i.game,"_"),i}return e(i,t),i.prototype.handleInput=function(e){switch(e||this.game.queueNextLevel(this.game.levels.world),e){case"ArrowUp":this.moveSkillCursor(1);break;case"ArrowDown":this.moveSkillCursor(-1)}},i.prototype.handleTouch=function(e){this.handleInput(null)},i.prototype.levelWillStart=function(){var e=this;this.updateBoxes(),this.game.player.setConvoMode(!0),this.game.player.convoLook(d.Direction.Right);var t=new s.default(this.game);t.setConvoMode(!0),this.buddies=[this.game.player,t],this.skills=this.game.player.skills.map(function(t){return new a.default(e.game,t)})},i.prototype.levelStarted=function(){this.moveBuddies()},i.prototype.resize=function(){this.configureDrawablesAndUpdateables()},i.prototype.update=function(e){t.prototype.update.call(this,e),this.updateText()},i.prototype.configureDrawablesAndUpdateables=function(){t.prototype.configureDrawablesAndUpdateables.call(this),this.updateBoxes(),this.updateText(),this.moveSkillCursor(0),this.moveBuddies(),this.generateTileIndexes(),this.generateTiles(),this.addDrawables(this.tiles,0),this.addDrawables(this.buddies,1),this.addOverlayDrawables([this.box,this.upArrow,this.downArrow].concat(this.skills))},i.prototype.generateTileIndexes=function(){var e=this.game.sizeInTiles(),t=this.game.player.tileIndex.y;this.tileIndexes=new Array(e.height).fill(null).map(function(){return new Array(e.width).fill(null).map(function(){return p.randomIndexFromArray([0,1])})});for(var i=0;i<t;i++)this.tileIndexes[i]=this.tileIndexes[i].map(function(){return 2});var r=this.tileIndexes[t-1];r&&(this.tileIndexes[t-1]=r.map(function(){return 3}))},i.prototype.moveSkillCursor=function(e){var t=this.currentSkillIndex+e,i=this.skills[t];this.downArrow.alpha=1,this.upArrow.alpha=1,this.skills.forEach(function(e){return e.alpha=d.DISABLED_ALPHA}),i?(i.alpha=1,this.currentSkillIndex=t):this.skills[this.currentSkillIndex].alpha=1,0===this.currentSkillIndex&&(this.downArrow.alpha=d.DISABLED_ALPHA),this.currentSkillIndex===this.skills.length-1&&(this.upArrow.alpha=d.DISABLED_ALPHA)},i.prototype.moveBuddies=function(){var e=this.buddies[1],t=this.game.gameCoordsFromDrawingCoords(this.box.pos),i=this.game.gameSizeFromDrawingSize(this.box.drawingSize),r=this.game.player.size.width+g+e.size.width,s={x:t.x+(i.width-r)/2,y:t.y-w},o=Object.assign({},s);o.x+=g+this.game.player.size.width,this.game.player.move(s,!1),e.move(o,!1)},i.prototype.updateBoxes=function(){var e=Math.floor(this.game.canvas.width/this.game.squareSize-this.game.squareSize),t=this.game.squareSize*c,i=this.game.canvas.height-t*this.game.squareSize-2*this.game.squareSize;this.box.move({x:this.game.squareSize*f,y:i}),this.box.updateSize({height:t,width:e})},i.prototype.updateText=function(){var e=this,t=x*this.game.squareSize,i=this.box.pos.x+this.box.drawingSize.width-this.upArrow.drawingSize.width-t,r=Math.floor(this.box.pos.y+this.box.drawingSize.height/2-this.upArrow.drawingSize.height/2),s=this.box.pos.x+t,o=r;this.upArrow.move({x:i,y:r}),this.downArrow.move({x:s,y:o}),this.skills.forEach(function(t,i){var r=e.currentSkillIndex-i,s=Math.floor(e.box.pos.x+e.box.drawingSize.width/2-t.drawingSize.width/2),o=Math.floor(e.box.pos.y+e.box.drawingSize.height/2-t.drawingSize.height/2+r*d.LINE_HEIGHT);t.move({x:s,y:o}),t.visible=!(Math.abs(r)>1)})},i}(i.default);exports.default=m;
},{"./level":"pM81","../box":"Koi2","../buddy":"tOHD","../colors":"aYI3","../text":"27c9","../tiles/flowers":"A1jt","../tiles/green":"978g","../tiles/sky":"I87v","../tiles/tree":"liEn","../common":"5ywg","../helpers":"eAYL"}],"uy6X":[function(require,module,exports) {
"use strict";var t=this&&this.__extends||function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r])};return function(e,r){function o(){this.constructor=e}t(e,r),e.prototype=null===r?Object.create(r):(o.prototype=r.prototype,new o)}}(),e=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};exports.__esModule=!0;var r=e(require("./tile")),o=require("../helpers"),n=function(e){function r(t,r,n){var i=e.call(this,t,r,n)||this;return i.name="door",i.interactable=!0,i.colorMatrix=o.singleColorTileArray(0),i.cacheOffscreenContext(),i}return t(r,e),r}(r.default);exports.default=n;
},{"./tile":"uUjA","../helpers":"eAYL"}],"8U42":[function(require,module,exports) {
"use strict";var t=this&&this.__extends||function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r])};return function(e,r){function i(){this.constructor=e}t(e,r),e.prototype=null===r?Object.create(r):(i.prototype=r.prototype,new i)}}(),e=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};exports.__esModule=!0;var r=e(require("../colors")),i=e(require("../text")),o=e(require("../tiles/door")),a=e(require("./level")),n="zzzzzz...",s=1200,l=function(e){function a(t){var a=e.call(this,t)||this;return a.tileTypeMap=[o.default],a.tileIndexes=[[]],a.startedSleepAt=null,a.text=new i.default(a.game,n,r.default[1]),a}return t(a,e),a.prototype.resize=function(){this.configureDrawablesAndUpdateables()},a.prototype.configureDrawablesAndUpdateables=function(){e.prototype.configureDrawablesAndUpdateables.call(this),this.generateTileIndexes(),this.generateTiles(),this.moveText(),this.addDrawables(this.tiles,0),this.addOverlayDrawables([this.text])},a.prototype.handleInput=function(){},a.prototype.handleTouch=function(){},a.prototype.levelStarted=function(){this.startedSleepAt=null,this.game.player.energy=1},a.prototype.update=function(t){this.startedSleepAt||(this.startedSleepAt=t),t-this.startedSleepAt>s&&this.game.queueNextLevel(this.game.levels.world)},a.prototype.moveText=function(){var t=this.game.canvas.width,e=this.game.canvas.height,r=Math.floor((t-this.text.drawingSize.width)/2),i=Math.floor((e-this.text.drawingSize.height)/2);this.text.move({x:r,y:i})},a}(a.default);exports.default=l;
},{"../colors":"aYI3","../text":"27c9","../tiles/door":"uy6X","./level":"pM81"}],"Y022":[function(require,module,exports) {
"use strict";var t=this&&this.__extends||function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r])};return function(e,r){function o(){this.constructor=e}t(e,r),e.prototype=null===r?Object.create(r):(o.prototype=r.prototype,new o)}}(),e=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};exports.__esModule=!0;var r=e(require("./tile")),o=function(e){function r(t,r,o){var n=e.call(this,t,r,o)||this;return n.name="grass",n.colorMatrix=[[2,2,2,2,2,2,2,2],[2,2,2,2,2,2,2,2],[2,2,3,2,2,2,2,2],[2,2,2,2,2,2,2,2],[2,2,2,2,2,2,3,2],[2,2,2,2,2,2,2,2],[2,2,3,2,2,2,2,2],[2,2,2,2,2,2,2,2]],n.cacheOffscreenContext(),n}return t(r,e),r}(r.default);exports.default=o;
},{"./tile":"uUjA"}],"Wql6":[function(require,module,exports) {
"use strict";var t=this&&this.__extends||function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])};return function(e,i){function s(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(s.prototype=i.prototype,new s)}}(),e=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};exports.__esModule=!0;var i=e(require("../colors")),s=e(require("./level")),r=e(require("../text")),n=e(require("../tiles/flowers")),o=e(require("../tiles/grass")),a=e(require("../tiles/green")),l=e(require("../tiles/tree")),u=require("../common"),h="CONVO IRL",c="TAP TO PLAY",d=function(e){function s(t){var s=e.call(this,t)||this;return s.tileTypeMap=[a.default,n.default,o.default,l.default],s.tileIndexes=[[]],s.lastBlinkAt=0,s.title=new r.default(s.game,h,i.default[1]),s.instructions=new r.default(s.game,c,i.default[1]),s}return t(s,e),s.prototype.resize=function(){this.configureDrawablesAndUpdateables()},s.prototype.configureDrawablesAndUpdateables=function(){e.prototype.configureDrawablesAndUpdateables.call(this),this.generateTileIndexes(),this.generateTiles(),this.moveText(),this.addDrawables(this.tiles,0),this.addOverlayDrawables([this.title,this.instructions])},s.prototype.handleInput=function(){this.game.transitioning||this.game.queueNextLevel(this.game.levels.world)},s.prototype.handleTouch=function(){this.handleInput()},s.prototype.update=function(t){t-this.lastBlinkAt>u.BLINK_DURATION&&(this.instructions.visible=!this.instructions.visible,this.lastBlinkAt=t)},s.prototype.moveText=function(){var t=this.game.canvas.width,e=this.game.canvas.height,i=this.title.drawingSize.height+this.instructions.drawingSize.height+u.LINE_HEIGHT*this.game.squareSize,s=Math.floor((t-this.title.drawingSize.width)/2),r=Math.floor((e-i)/2),n=Math.floor((t-this.instructions.drawingSize.width)/2),o=r+u.LINE_HEIGHT*this.game.squareSize;this.title.move({x:s,y:r}),this.instructions.move({x:n,y:o})},s}(s.default);exports.default=d;
},{"../colors":"aYI3","./level":"pM81","../text":"27c9","../tiles/flowers":"A1jt","../tiles/grass":"Y022","../tiles/green":"978g","../tiles/tree":"liEn","../common":"5ywg"}],"VO2B":[function(require,module,exports) {
"use strict";var t=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};exports.__esModule=!0;var i=t(require("./box")),e=t(require("./colors")),s=t(require("./text")),h=require("./common"),r=.2,o=function(){function t(t,h){this.visible=!0,this.percentFull=1,this.lastBlinkAt=0,this.alpha=1,this.game=t,this.pos=h,this.energyText=new s.default(this.game,"ENERGY",e.default[7],{x:this.pos.x,y:this.pos.y}),this.energyText.shadow=!1,this.size=Object.assign({},this.energyText.size),this.drawingSize=Object.assign({},this.energyText.drawingSize),this.drawingSize.width=(this.size.width+1)*this.game.squareSize,this.drawingSize.height=(this.size.height+1)*this.game.squareSize;var r={height:this.size.height+1,width:this.size.width+1};this.box=new i.default(t,this.pos,r,e.default[7])}return t.prototype.move=function(t){this.pos.x=t.x,this.pos.y=t.y,this.box.move(this.pos),this.energyText.pos.x=t.x+h.SQUARE_SIZE/2+.5,this.energyText.pos.y=t.y+h.SQUARE_SIZE/2+.5},t.prototype.draw=function(t){this.box.draw(t),t.fillStyle=e.default[1],t.fillRect(this.pos.x,this.pos.y,this.drawingSize.width*this.percentFull,this.drawingSize.height),this.energyText.draw(t)},t.prototype.update=function(t){this.percentFull>r?this.visible=!0:t-this.lastBlinkAt>h.BLINK_DURATION&&(this.visible=!this.visible,this.lastBlinkAt=t)},t}();exports.default=o;
},{"./box":"Koi2","./colors":"aYI3","./text":"27c9","./common":"5ywg"}],"UEKO":[function(require,module,exports) {
"use strict";var t=this&&this.__extends||function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r])};return function(e,r){function n(){this.constructor=e}t(e,r),e.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}(),e=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};exports.__esModule=!0;var r=e(require("./tile")),n=require("../common"),o=function(e){function r(t,r,o){var i=e.call(this,t,r,o)||this;return i.name="house",i.colorMatrix=[[2,2,2,2,2,2,2,2,2,2,2,6,6,2,2,2,2,2,2,2,2,2,2,2],[2,2,2,2,2,2,2,2,2,2,6,6,6,6,2,2,2,2,2,2,2,2,2,2],[2,2,2,2,2,2,2,2,2,6,6,6,6,6,6,2,2,2,2,2,2,2,2,2],[2,2,2,2,2,2,2,2,6,6,6,6,6,6,6,6,2,2,2,2,2,2,2,2],[2,2,2,2,2,2,2,6,6,6,6,6,6,6,6,6,6,2,2,2,2,2,2,2],[2,2,2,2,2,2,6,6,6,6,6,6,6,6,6,6,6,6,2,2,2,2,2,2],[2,2,2,2,2,6,6,6,6,6,6,6,6,6,6,6,6,6,6,2,2,2,2,2],[2,2,2,2,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,2,2,2,2],[2,2,2,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,2,2,2],[2,2,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,2,2],[2,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,2],[6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6],[6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6],[6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6],[6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6],[6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6],[6,6,6,6,6,6,6,6,0,0,0,0,0,0,0,0,6,6,6,6,6,6,6,6],[6,6,6,6,6,6,6,6,0,0,0,0,0,0,0,0,6,6,6,6,6,6,6,6],[6,6,6,6,6,6,6,6,0,0,0,0,0,0,0,0,6,6,6,6,6,6,6,6],[6,6,6,6,6,6,6,6,0,0,0,0,0,0,0,0,6,6,6,6,6,6,6,6],[6,6,6,6,6,6,6,6,0,0,0,0,0,0,0,0,6,6,6,6,6,6,6,6],[6,6,6,6,6,6,6,6,0,0,0,0,0,0,0,0,6,6,6,6,6,6,6,6],[6,6,6,6,6,6,6,6,0,0,0,0,0,0,0,0,6,6,6,6,6,6,6,6],[6,6,6,6,6,6,6,6,0,0,0,0,0,0,0,0,6,6,6,6,6,6,6,6]],i.tileLength=3*n.TILE_SIZE,i.drawingSize={height:i.tileLength*i.game.squareSize,width:i.tileLength*i.game.squareSize},i.cacheOffscreenContext(),i}return t(r,e),r}(r.default);exports.default=o;
},{"./tile":"uUjA","../common":"5ywg"}],"UPFT":[function(require,module,exports) {
"use strict";var t=this&&this.__extends||function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r])};return function(e,r){function n(){this.constructor=e}t(e,r),e.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}(),e=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};exports.__esModule=!0;var r=e(require("./green")),n=function(e){function r(t,r,n){var o=e.call(this,t,r,n)||this;return o.name="unwalkable",o.walkable=!1,o.visible=!1,o.cacheOffscreenContext(),o}return t(r,e),r}(r.default);exports.default=n;
},{"./green":"978g"}],"GyKP":[function(require,module,exports) {
"use strict";var e=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])};return function(t,i){function r(){this.constructor=t}e(t,i),t.prototype=null===i?Object.create(i):(r.prototype=i.prototype,new r)}}(),t=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};exports.__esModule=!0;var i=t(require("./level")),r=t(require("../buddy")),a=t(require("../energy-bar")),s=t(require("../tiles/door")),n=t(require("../tiles/flowers")),o=t(require("../tiles/grass")),l=t(require("../tiles/green")),h=t(require("../tiles/house")),p=t(require("../tiles/tree")),c=t(require("../tiles/unwalkable")),u=require("../common"),y=require("../helpers"),d=100,g={x:4*u.TILE_SIZE,y:6*u.TILE_SIZE},f=function(t){function i(e){var i=t.call(this,e)||this;i.tileTypeMap=[l.default,n.default,o.default,p.default,h.default,c.default,s.default],i.tileIndexes=[[3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3],[3,3,3,3,3,3,3,0,0,0,3,3,3,3,0,0,0,0,0,3,3,3,3,3,3,3,3,3],[3,3,3,3,3,3,3,2,0,0,3,3,3,3,0,1,0,0,0,0,3,3,3,3,0,0,3,3],[3,3,3,4,5,5,3,0,0,2,0,3,3,3,0,0,0,0,0,0,3,3,3,0,0,0,3,3],[3,3,3,5,5,5,3,0,1,0,0,3,3,2,0,0,0,2,0,0,0,3,0,0,0,3,3,3],[3,3,3,5,6,5,3,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,3,3,3],[3,3,3,1,1,1,1,3,3,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,3],[3,3,3,1,1,1,1,3,3,3,3,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,3],[3,3,3,3,0,0,0,0,3,3,3,3,0,2,0,0,0,0,0,0,0,0,0,0,0,0,0,3],[3,0,2,3,0,0,2,0,0,3,3,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,3],[3,0,0,3,3,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,3],[3,0,0,2,3,3,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,3,0,0,0,0,0,3],[3,1,0,3,3,3,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,3,0,0,0,0,3],[3,0,0,3,3,2,0,0,0,0,0,0,0,0,0,0,0,0,0,3,0,0,2,3,0,0,0,3],[3,0,0,3,3,0,0,0,2,0,0,0,0,0,0,0,0,0,0,3,3,0,0,2,3,3,3,3],[3,0,0,3,0,0,0,0,0,0,1,3,3,0,0,0,0,0,0,0,3,3,0,0,4,5,5,3],[3,0,0,0,0,0,0,0,3,3,3,3,0,1,0,0,0,0,0,0,3,3,0,0,5,5,5,3],[3,0,0,3,3,3,0,3,3,3,3,0,0,0,0,0,3,3,3,3,3,3,0,0,5,6,5,3],[3,3,3,3,3,3,3,3,3,3,3,2,0,0,0,0,0,3,3,3,3,3,0,2,1,1,1,3],[3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3]],i.playerSpawnPosition=g,i.inputBuffer={pressedAt:0,key:null},i.generateTiles(),i.energyBar=new a.default(i.game,{x:0,y:u.SQUARE_SIZE}),i.game.player.energy=.6;var y=new r.default(e);return y.move({x:10*u.TILE_SIZE,y:10*u.TILE_SIZE}),i.buddies=[y],i}return e(i,t),i.prototype.handleInput=function(e){this.inputBuffer={pressedAt:this.game.timestamp,key:e}},i.prototype.handleTouch=function(e){if(!this.game.player.walking){var t=this.game.camera,i=t.size,r=i.height,a=i.width,s=t.offset,n=e.clientX*a/window.innerWidth-s.x,o=e.clientY*r/window.innerHeight-s.y,l=n-this.game.player.pos.x*this.game.squareSize,h=o-this.game.player.pos.y*this.game.squareSize,p=Math.abs(l),c=Math.abs(h),y=this.game.squareSize*u.HALF_TILE_SIZE;if(!(p<y&&c<y))if(p>c)this.movePlayerHorizontally(l)||this.movePlayerVertically(h);else this.movePlayerVertically(h)||this.movePlayerHorizontally(l)}},i.prototype.resize=function(){var e=Math.floor((this.game.canvas.width-this.energyBar.drawingSize.width)/2);this.energyBar.move({x:e,y:this.energyBar.pos.y})},i.prototype.update=function(e){t.prototype.update.call(this,e),this.processInput()},i.prototype.configureDrawablesAndUpdateables=function(){t.prototype.configureDrawablesAndUpdateables.call(this),this.addDrawables(this.tiles,0),this.addDrawables(this.game.player.dusts,1),this.addDrawables([this.game.player],2),this.addDrawables(this.buddies,2),this.addOverlayDrawables([this.energyBar]),this.addInteractables(this.buddies),this.addUpdateables(this.game.player.dusts.concat([this.energyBar])),this.resize()},i.prototype.levelStarted=function(){this.energyBar.percentFull=this.game.player.energy,this.game.player.move(this.playerSpawnPosition,!1),this.game.player.setConvoMode(!1)},i.prototype.processInput=function(){if(!(this.game.timestamp-this.inputBuffer.pressedAt>d))switch(this.inputBuffer.key){case"ArrowUp":this.walk(u.Direction.Up);break;case"ArrowDown":this.walk(u.Direction.Down);break;case"ArrowRight":this.walk(u.Direction.Right);break;case"ArrowLeft":this.walk(u.Direction.Left)}},i.prototype.walk=function(e){if(!this.game.player.walking){Object.assign({},this.game.player.tileIndex);var t=Object.assign({},this.game.player.tileIndex);switch(e){case u.Direction.Up:t.y-=1;break;case u.Direction.Down:t.y+=1;break;case u.Direction.Left:t.x-=1;break;case u.Direction.Right:t.x+=1}var i=null;if(this.interactables.find(function(e){return e.tileIndex.x===t.x&&e.tileIndex.y===t.y})&&(i=this.game.levels.convo),this.tileAtIndex(t).interactable&&(i=this.game.levels.sleep),i)return this.playerSpawnPosition.x=this.game.player.pos.x,this.playerSpawnPosition.y=this.game.player.pos.y,void this.game.queueNextLevel(i);this.game.player.walk(e)}},i.prototype.movePlayerVertically=function(e){return e<0&&this.canThingMoveInDirection(this.game.player,u.Direction.Up)?(this.handleInput("ArrowUp"),!0):!!(e>0&&this.canThingMoveInDirection(this.game.player,u.Direction.Down))&&(this.handleInput("ArrowDown"),!0)},i.prototype.movePlayerHorizontally=function(e){return e>0&&this.canThingMoveInDirection(this.game.player,u.Direction.Right)?(this.handleInput("ArrowRight"),!0):!!(e<0&&this.canThingMoveInDirection(this.game.player,u.Direction.Left))&&(this.handleInput("ArrowLeft"),!0)},i.prototype.canThingMoveInDirection=function(e,t){var i=Object.assign({},e.pos);switch(t){case u.Direction.Up:i.y-=this.game.tileSize;break;case u.Direction.Down:i.y+=this.game.tileSize;break;case u.Direction.Left:i.x-=this.game.tileSize;break;case u.Direction.Right:i.x+=this.game.tileSize}return i.x=i.x-i.x%this.game.tileSize,i.y=i.y-i.y%this.game.tileSize,y.canThingMoveToPosition(e,i,this)},i}(i.default);exports.default=f;
},{"./level":"pM81","../buddy":"tOHD","../energy-bar":"VO2B","../tiles/door":"uy6X","../tiles/flowers":"A1jt","../tiles/grass":"Y022","../tiles/green":"978g","../tiles/house":"UEKO","../tiles/tree":"liEn","../tiles/unwalkable":"UPFT","../common":"5ywg","../helpers":"eAYL"}],"dgAm":[function(require,module,exports) {
"use strict";var t=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};exports.__esModule=!0;var e=require("./common"),i=require("./animations"),s=require("./helpers"),n=t(require("./buddy")),a=t(require("./levels/convo")),r=t(require("./levels/sleep")),h=t(require("./levels/start-screen")),o=t(require("./levels/world")),l=5,c=function(){function t(t){this.timestamp=0,this.tileSize=e.TILE_SIZE,this.squareSize=e.SQUARE_SIZE,this.nextLevel=null,this.imageOfPreviousLevel=null,this.player=new n.default(this),this.canvas=t,this.setSize(),this.context=t.getContext("2d",{alpha:!1}),this.context.mozImageSmoothingEnabled=!1,this.context.webkitImageSmoothingEnabled=!1,this.context.msImageSmoothingEnabled=!1,this.context.imageSmoothingEnabled=!1,this.context.webkitImageSmoothingEnabled=!1,this.context.mozImageSmoothingEnabled=!1,this.levels={convo:new a.default(this),sleep:new r.default(this),startScreen:new h.default(this),world:new o.default(this)},this.transition=Object.assign({},i.transition),this.switchLevel(this.levels.startScreen)}return Object.defineProperty(t.prototype,"transitioning",{get:function(){return this.transition.running},enumerable:!0,configurable:!0}),t.prototype.update=function(t){this.timestamp=t,this.currentLevel.update(t),this.transitioning&&this.updateTransition(t)},t.prototype.draw=function(t){this.context&&this.camera&&(this.camera.updateScreenShake(t),this.clearCanvasContext(),this.drawDrawables(t),this.drawOverlayDrawables(t),this.transitioning&&this.updateTransition(t))},t.prototype.resize=function(){this.setSize(),this.currentLevel.resize()},t.prototype.queueNextLevel=function(t){this.nextLevel=t,this.startTransition()},t.prototype.handleInput=function(t){this.currentLevel.handleInput(t)},t.prototype.handleTouch=function(t){this.currentLevel.handleTouch(t)},t.prototype.gameCoordsFromDrawingCoords=function(t){var e=Object.assign({},t);return e.x=Math.floor(e.x/this.squareSize),e.y=Math.floor(e.y/this.squareSize),e},t.prototype.gameSizeFromDrawingSize=function(t){var e=Object.assign({},t);return e.width=Math.floor(e.width/this.squareSize),e.height=Math.floor(e.height/this.squareSize),e},t.prototype.sizeInTiles=function(){return{width:Math.ceil(this.canvas.width/this.squareSize/e.TILE_SIZE),height:Math.ceil(this.canvas.height/this.squareSize/e.TILE_SIZE)}},t.prototype.startTransition=function(){this.transition.startTime=this.timestamp,this.transition.running=!0,this.imageOfPreviousLevel=new Image,this.imageOfPreviousLevel.src=this.canvas.toDataURL("png"),this.switchLevel(this.nextLevel)},t.prototype.setSize=function(){this.size={height:this.canvas.height/this.squareSize,width:this.canvas.width/this.squareSize},this.drawingSize={height:this.canvas.height,width:this.canvas.width}},t.prototype.updateTransition=function(t){var e=(t-this.transition.startTime)/this.transition.duration;this.transition.prevLevelScale=s.clerp(1,l,1,l,e),this.transition.prevLevelAlpha=s.clerp(1,0,0,1,e),this.transition.nextLevelAlpha=s.clerp(0,1,0,1,e),e>=1&&(this.transition=Object.assign({},i.transition),this.imageOfPreviousLevel=null)},t.prototype.switchLevel=function(t){this.currentLevel=t,t.levelWillStart(),t.configureDrawablesAndUpdateables(),t.levelStarted()},t.prototype.drawDrawables=function(t){var e=this,i=this.camera.offset;if(this.currentLevel.drawables.forEach(function(s){s.forEach(function(s){if(s.visible){var n=s.pos.x*e.squareSize+i.x,a=s.pos.y*e.squareSize+i.y;e.isOffScreen(n,a,s.drawingSize)||(e.context.translate(n+.5|0,a+.5|0),e.context.globalAlpha=e.transitioning?e.transition.nextLevelAlpha:1,s.draw(e.context,t),e.context.setTransform(1,0,0,1,0,0))}})}),this.context.globalAlpha=1,this.imageOfPreviousLevel){this.context.globalAlpha=this.transition.prevLevelAlpha;var s=this.transition.prevLevelScale,n=(this.canvas.width*s-this.canvas.width)/2,a=(this.canvas.height*s-this.canvas.height)/2;this.context.drawImage(this.imageOfPreviousLevel,-n,-a,this.canvas.width*s,this.canvas.height*s),this.context.globalAlpha=1}},t.prototype.isOffScreen=function(t,e,i){return t+i.width<0||t>this.canvas.width||e+i.height<0||e>this.canvas.height},t.prototype.drawOverlayDrawables=function(t){var e=this;this.transitioning&&(this.context.globalAlpha=this.transition.nextLevelAlpha),this.currentLevel.overlayDrawables.forEach(function(i){i.visible&&i.draw(e.context,t)}),this.context.globalAlpha=1},t.prototype.clearCanvasContext=function(){this.transitioning&&(this.context.globalAlpha=this.transition.nextLevelAlpha),this.context.fillStyle=this.currentLevel.backgroundColor,this.context.fillRect(0,0,this.canvas.width,this.canvas.height)},t}();exports.default=c;
},{"./common":"5ywg","./animations":"oinf","./helpers":"eAYL","./buddy":"tOHD","./levels/convo":"jLKC","./levels/sleep":"8U42","./levels/start-screen":"Wql6","./levels/world":"GyKP"}],"Qu5t":[function(require,module,exports) {
"use strict";exports.__esModule=!0;var r=require("./common"),e=10*r.MS_PER_UPDATE;function t(r,t,o){var n=0,u=0;return function(a){for(n+=Math.min(a-u,e),u=a;n>=r;)t.call(o,a),n-=r}}exports.default=t;
},{"./common":"5ywg"}],"9B6d":[function(require,module,exports) {
"use strict";var e=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};exports.__esModule=!0;var n=e(require("./camera")),t=e(require("./game")),i=e(require("./game-loop")),d=require("./common"),o=i.default(d.MS_PER_UPDATE,E,this),r=document.getElementById("game"),u=new t.default(r),a=new n.default(u),s=d.NUM_TILES_ON_LONG_SIDE*d.TILE_SIZE*d.SQUARE_SIZE,w=s,c=s,h=null,v=!1;u.camera=a;var m={s:a.shakeScreen.bind(a),t:function(){return u.queueNextLevel(u.levels.world)}};function l(){var e=window.innerWidth/window.innerHeight;e>=1?c=(w=s)/e:w=(c=s)*e,r.width=w,r.height=c,a.size={width:r.width,height:r.height},u.resize()}function E(e){u.update(e),a.move(u.player)}function f(e){h&&v&&u.handleTouch(h),o(e),u.draw(e),requestAnimationFrame(f)}function _(e){L(e),v=!0}function L(e){var n=e;e.touches&&(n=e.changedTouches[0]),h=n}function g(){h=null,v=!1}l(),requestAnimationFrame(f),window.addEventListener("resize",function(){return l()}),window.addEventListener("keydown",function(e){var n=e.key;m[n]?m[n]():u.handleInput(n)}),window.addEventListener("mousedown",_,!1),window.addEventListener("touchstart",_,!1),window.addEventListener("mouseup",g,!1),window.addEventListener("touchend",g,!1),window.addEventListener("mousemove",L,!1),window.addEventListener("touchmove",L,!1),document.body.addEventListener("touchmove",function(e){return e.preventDefault()},{passive:!1});
},{"./camera":"LnVe","./game":"dgAm","./game-loop":"Qu5t","./common":"5ywg"}]},{},["9B6d"], null)</script> </body> </html>